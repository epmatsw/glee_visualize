<html>
  <head>
    <title>Les Mis&eacute;rables Arc</title>
    <link type="text/css" rel="stylesheet" href="ex.css?3.2"/>
    <script type="text/javascript" src="protovis.min.js"></script>
    <script type="text/javascript" src="counts.js"></script>
    <style type="text/css">

#fig {
  width: 1080px;
  height: 600px;
}

    </style>
  </head>
  <body><div id="center"><div id="fig">
    <script type="text/javascript+protovis">

var vis = new pv.Panel()
    .width(1180)
    .height(510)
    .bottom(90);
  var files = [];
  var links = [];    
  for(var i = 0; i < filecounts.length; i++)
  {
    files.push(filecounts[i].file.replace("/Users/willstamper/github/iron/client/public/","").replace(".coffee",""));
  }
  for(var i = 0; i < filecounts.length; i++)
{
    for(var j = 0; j < filecounts[i].counts.length; j++)
    {
      var s = i;
      console.log(filecounts[i].counts[j].path);
      var t = files.indexOf(filecounts[i].counts[j].path);
      var v = Number(filecounts[i].counts[j].count);
      if(t!=-1)
      {
        console.log(s + " " + t + " " + v);
        links.push({"source":s, "target":t, "value":v});
      }
    }
}
  var nodes = [];
  for(var i = 0; i < files.length; i++)
{
  var temp = files[i].replace("_view_controller","").replace("_model","");
  nodes.push({"nodeValue":temp.substring(temp.lastIndexOf("/")+1)});
}
  var arc = vis.add(pv.Layout.Arc)
    .nodes(nodes)
    .links(links)

arc.link.add(pv.Line);

arc.node.add(pv.Dot)
  .size(function(d) d.linkDegree + 4 )
    .fillStyle(pv.Colors.category19().by(function(d) d.group))
    .strokeStyle(function() this.fillStyle().darker());

arc.label.add(pv.Label)

vis.render();

    </script>
  </div></div></body>
</html>
